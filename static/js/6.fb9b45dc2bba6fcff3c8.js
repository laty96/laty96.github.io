webpackJsonp([6],{"/Gy+":function(t,e){},XDdL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("r5kb"),a=i("N+h9"),o=i("Zrlr"),n=i.n(o),c=i("yp89"),l=function t(e){n()(this,t),this.id=Object(c.a)(),this.order_id=e.order_id,this.items=e.items,this.is_confirmed=!1,this.created_time=Date.now(),this.completed_time="",this.type=e.type},r=function t(e){n()(this,t),this.id=Object(c.a)(),this.name=e.name||"user",this.items=e.items,this.employee_id=e.employee_id||"",this.store_id=e.store_id||"",this.created_time=Date.now(),this.is_done=!1},_=function t(e){n()(this,t),this.id=Object(c.a)(),this.order_id=e.order_id,this.ticket_id=e.ticket_id,this.items=e.items,this.total=+this.items.price*+this.items.quantity,this.created_time=Date.now(),this.completed_time=null,this.is_done=!1,this.type=e.type},d={name:"import",data:function(){return{items:[],bill:[],detail:""}},methods:{order:function(t){if(t.quantity){t.quantity=+t.quantity;var e=new r({items:[t]}),i=new l({order_id:e.id,items:t,type:"import"}),a=new _({order_id:e.id,ticket_id:i.id,items:t,type:"import"});s.a.setCollection("ImportOrder").create(e,function(t){return console.log(t)}),s.a.setCollection("ImportTicket").create(i,function(t){return console.log(t)}),s.a.setCollection("ImportBill").create(a,function(t){return console.log(t)})}},fetchDetail:function(t){this.detail=t},checkout:function(t){s.a.setCollection("ImportBill").update(t._id,{is_done:!0,completed_time:Date.now()});var e=(new Date).getMonth()+"_"+(new Date).getFullYear();s.a.setCollection("money").get(e,function(i){console.log(i),i?s.a.setCollection("money").update(e,{money:+i.money-+t.total}):s.a.setCollection("money").set(e,{money:+-t.total})}),s.a.setCollection("ImportTicket").getWithCondition([{field:"id",op:"==",value:t.ticket_id}],function(t){s.a.setCollection("items").getWithCondition([{field:"id",op:"==",value:t[0].items.id}],function(e){s.a.setCollection("items").update(e[0]._id,{stock:+e[0].stock+ +t[0].items.quantity})})})},cancel:function(t){s.a.setCollection("ImportBill").update(t._id,{is_done:!1,completed_time:Date.now()});var e=(new Date).getMonth()+"_"+(new Date).getFullYear();s.a.setCollection("money").get(e,function(i){i?s.a.setCollection("money").update(e,{money:+i.money+ +t.total}):s.a.setCollection("money").set(e,{money:+-t.total})}),s.a.setCollection("ImportTicket").getWithCondition([{field:"id",op:"==",value:t.ticket_id}],function(t){s.a.setCollection("items").getWithCondition([{field:"id",op:"==",value:t[0].items.id}],function(e){s.a.setCollection("items").update(e[0]._id,{stock:+e[0].stock-+t[0].items.quantity})})})}},created:function(){var t=this;s.a.setFirebaseDB(a.a),s.a.setCollection("items").setOrderBy("created_time","desc").getAllRealTime(function(e){t.items=e}),s.a.setCollection("ImportBill").setOrderBy("created_time","desc").getAllRealTime(function(e){t.bill=e,console.log(e)})}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[t._m(0),t._v(" "),i("div",{staticClass:"tab-content mt-1"},[i("div",{staticClass:"container tab-pane active",attrs:{id:"menu1"}},[i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.items,function(e,s){return i("tr",{key:s},[i("th",{attrs:{scope:"row"}},[t._v(t._s(s+1))]),t._v(" "),i("td",[t._v(t._s(e.id))]),t._v(" "),i("td",[t._v(t._s(e.name))]),t._v(" "),i("td",[t._v(t._s(e.stock))]),t._v(" "),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity,expression:"item.quantity"}],attrs:{type:"number"},domProps:{value:e.quantity},on:{input:function(i){i.target.composing||t.$set(e,"quantity",i.target.value)}}})]),t._v(" "),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"item.price"}],attrs:{type:"number"},domProps:{value:e.price},on:{input:function(i){i.target.composing||t.$set(e,"price",i.target.value)}}})]),t._v(" "),i("td",[i("button",{staticClass:"btn btn-primary",on:{click:function(i){t.order(e)}}},[t._v("Order")])])])}))])]),t._v(" "),i("div",{staticClass:"container tab-pane",attrs:{id:"menu2"}},[t._v("\n        "+t._s(t.bill)+"\n        "),i("table",{staticClass:"table"},[t._m(2),t._v(" "),i("tbody",t._l(t.bill,function(e,s){return i("tr",{key:s},[i("th",{attrs:{scope:"row"}},[t._v(t._s(s+1))]),t._v(" "),i("td",[t._v(t._s(e.id))]),t._v(" "),i("td",[t._v(t._s(e.ticket_id))]),t._v(" "),i("td",[t._v(t._s(e.order_id))]),t._v(" "),i("td",[t._v(t._s(e.items.name))]),t._v(" "),i("td",[t._v(t._s(e.total))]),t._v(" "),i("td",[t._v(t._s(new Date(e.completed_time).toLocaleDateString()))]),t._v(" "),i("td",[t._v(t._s(e.is_done?"Done":"Pending"))]),t._v(" "),i("td",[i("button",{staticClass:"btn btn-primary",on:{click:function(i){t.fetchDetail(e)}}},[t._v("Detail")]),t._v(" "),e.is_done?t._e():i("button",{staticClass:"btn btn-primary",on:{click:function(i){t.checkout(e)}}},[t._v("Checkout")]),t._v(" "),e.is_done?i("button",{staticClass:"btn btn-primary",on:{click:function(i){t.cancel(e)}}},[t._v("Cancel")]):t._e()])])}))]),t._v(" "),t.detail?i("div",{staticClass:"card"},[i("div",{staticClass:"card-header"},[i("h3",[t._v("Bill ID: "+t._s(t.detail.id))])]),t._v(" "),i("div",{staticClass:"card-body"},[i("p",[t._v("Name: "+t._s(t.detail.name))]),t._v(" "),i("p",[t._v("Date: "+t._s(t.detail.created_time))]),t._v(" "),i("p",[t._v("Employee: "+t._s(t.detail.employee_id))]),t._v(" "),i("p",[t._v("Status: "+t._s(t.detail.is_done?"Done":"Pending"))]),t._v(" "),t._m(3),t._v(" "),i("div",{staticClass:"collapse",attrs:{id:"collapseExample"}},t._l(t.detail.items,function(e,s){return i("div",{key:s,staticClass:"card card-body m-1"},[i("p",[t._v("ID: "+t._s(e.id))]),t._v(" "),i("p",[t._v("Name: "+t._s(e.name))]),t._v(" "),i("p",[t._v("Price: "+t._s(e.price))]),t._v(" "),i("p",[t._v("Quantity: "+t._s(e.quantity))]),t._v(" "),i("p",[t._v("Stock: "+t._s(e.stock))]),t._v(" "),i("p",[t._v("Added Time: "+t._s(e.created_time))])])}))])]):t._e()])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"nav nav-tabs"},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{"data-toggle":"tab",href:"#menu1"}},[this._v("Create Import Ticket")])]),this._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#menu2"}},[this._v("Pay")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",{staticClass:"thead-dark"},[i("tr",[i("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("ID")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Name")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Stock")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Quantity")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Price")]),t._v(" "),i("th",{attrs:{scope:"col"}})])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",{staticClass:"thead-dark"},[i("tr",[i("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("ID")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("TicketID")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("OrderID")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Name")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Total")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Completed time")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Status")]),t._v(" "),i("th",{attrs:{scope:"col"}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("a",{staticClass:"btn btn-primary",attrs:{"data-toggle":"collapse",href:"#collapseExample",role:"button","aria-expanded":"false","aria-controls":"collapseExample"}},[this._v("\n                Items\n              ")])])}]};var m=i("VU/8")(d,v,!1,function(t){i("/Gy+")},null,null);e.default=m.exports}});
//# sourceMappingURL=6.fb9b45dc2bba6fcff3c8.js.map