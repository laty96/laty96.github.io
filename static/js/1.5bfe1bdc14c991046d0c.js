webpackJsonp([1],{"9r0o":function(t,e,i){"use strict";var s=i("Zrlr"),n=i.n(s),o=i("yp89");e.a=function t(e){n()(this,t),this.id=Object(o.a)(),this.order_id=e.order_id,this.ticket_id=e.ticket_id,this.items=[],this.total=e.total||this.items?+this.items.reduce(function(t,e){return+t+ +e.final_price*+e.quantity},0):0,this.created_time=Date.now(),this.completed_time=null,this.is_done=!1,this.type=e.type}},WdvJ:function(t,e,i){"use strict";var s=i("woOf"),n=i.n(s),o=i("Dd8w"),c=i.n(o),a=i("r5kb"),r=c()({incomePerEmployee:function(t,e){if(!this.checkRequiredProperty())return this.getWithOrderBy("employeeId",t,e),this},incomePerStore:function(t,e){if(!this.checkRequiredProperty())return this.getWithOrderBy("storeId",t,e),this},getItems:function(t){if(!this.checkRequiredProperty())return this.getAll(t),this},getCustomer:function(t,e,i){var s=this,n=this;if(this.setOrderBy("customerId"),!this.checkRequiredProperty())return this.firebaseDB.collection(this.collection).where("customerId","==",t).get().then(function(t){docs.empty?(i(t),n.noData()):e(t[0].data())}).catch(function(t){i(t),s.error(t)}),this},getAllCustomers:function(t){if(!this.checkRequiredProperty())return this.getAll(t),this},getTicketStatus:function(t,e){this.firebaseDB.collection(this.collection).doc(t).update({status:null})},createItemWithDiscount:function(t,e){this.firebaseDB.collection(this.collection).doc(e).update({discountType:t.type,discountValue:t.value})},createComboDeal:function(t,e){for(var i=arguments.length,s=Array(i>2?i-2:0),n=2;n<i;n++)s[n-2]=arguments[n];var o=new(Function.prototype.bind.apply(ComboModel,[null].concat([e],s)));this.create(o,t)},updateBill:function(t,e){this.firebaseDB.collection(this.collection).doc(t).update(e)},create:function(t,e,i){var s=this,o=n()({},t);return console.log(o),this.firebaseDB.collection(this.collection).add(o).then(function(t){return e(t.id)}).catch(function(t){i(t),s.error(t)}),this},getAll:function(t){var e=this;return this.firebaseDB.collection(this.collection).orderBy(this.orderBy).get().then(function(e){if(!e.empty){var i=[];e.forEach(function(t){i.push(t.data())}),t(i)}}).catch(function(t){return e.error(t)}),this},getWithOrderBy:function(t,e,i){var s=this,n=this;this.minTime&&this.maxTime?this.firebaseDB.collection(this.collection).where(t,"==",e).where("createdTime",">",this.minTime).where("createdTime","<",this.maxTime).orderBy(this.orderBy).get().then(function(t){if(t.empty)n.noData();else{var e=[];t.forEach(function(t){e.push(t.data())}),i(e)}}).catch(function(t){return s.error(t)}):this.firebaseDB.collection(this.collection).where(t,"==",e).orderBy(this.orderBy).get().then(function(t){if(t.empty)n.noData();else{var e=[];t.forEach(function(t){e.push(t.data())}),i(e)}}).catch(function(t){return s.error(t)})}},a.a);e.a=r},b4su:function(t,e){},lO7g:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("BO1k"),n=i.n(s),o=i("Zrlr"),c=i.n(o),a=i("yp89"),r=function t(e){c()(this,t),this.id=Object(a.a)(),this.order_id=e.order_id,this.items=e.items,this.is_confirmed=!1,this.created_time=Date.now(),this.completed_time="",this.type=e.type},l=function t(e){c()(this,t),this.id=Object(a.a)(),this.name=e.name||"user",this.items=e.items,this.employee_id=e.employee_id||"",this.store_id=e.store_id||"",this.created_time=Date.now(),this.completed_time="",this.is_done=!1},u=i("9r0o"),d=i("WdvJ"),h=i("N+h9"),_={name:"home",data:function(){return{items:[],limit:0,collection:"exportTickets",cart:[],combo:[],discount_percent:0,discount_value:0}},methods:{getDiscount:function(t,e){var i=this,s=[{field:"item_id",op:"==",value:t},{field:"end_time",op:">",value:Date.now()}];d.a.setCollection("discount").getWithCondition(s,function(t){i.items[e].discount_percent=(+t.discount_percent||0)+ +i.discount_percent,i.items[e].discount_value=(+t.discount_value||0)+ +i.discount_value})},add:function(t){var e=0,i=!0,s=!1,o=void 0;try{for(var c,a=n()(this.cart);!(i=(c=a.next()).done);i=!0){c.value.id==t.id&&e++}}catch(t){s=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(s)throw o}}t.quantity=1,0==e&&this.cart.push(t)},remove:function(t){this.cart.splice(t,1)},buy:function(){var t=new l({items:this.cart}),e=new r({items:this.cart,order_id:t.id,type:"export"}),i=new u.a({items:this.cart,order_id:t.id,ticket_id:e.id,type:"export"});d.a.setFirebaseDB(h.a),d.a.setCollection("orders").create(t,function(t){console.log(t)}),d.a.setCollection("tickets").create(e,function(t){console.log(t)}),d.a.setCollection("bills").create(i,function(t){console.log(t)}),this.cart=[]},more:function(){this.limit+=10,this.getItem()},getItem:function(){var t=this;d.a.setFirebaseDB(h.a).setCollection("items").setOrderBy("created_time").getWithConditionRealTime([{field:"stock",op:">",value:0}],function(e){t.items=e,e.forEach(function(e,i){var s=[{field:"item_id",op:"==",value:e.id},{field:"end_time",op:">",value:Date.now()}];d.a.setCollection("discount").getWithCondition(s,function(e){e||(t.$set(t.items[i],"discount_percent",+t.discount_percent),t.$set(t.items[i],"discount_value",+t.discount_value)),t.$set(t.items[i],"discount_percent",+t.discount_percent),t.$set(t.items[i],"discount_value",+t.discount_value),e[0].start_time<Date.now()&&(t.items[i].discount_percent+=+e[0].discount_percent,t.items[i].discount_value+=+e[0].discount_value)})}),console.log(e)})}},created:function(){var t=this;d.a.setFirebaseDB(h.a).setCollection("combo").setOrderBy("created_time").getAllRealTime(function(e){t.combo=e,t.combo&&t.combo.forEach(function(e,i){var s=9999,o=[],c=!0,a=!1,r=void 0;try{for(var l,u=n()(e.items);!(c=(l=u.next()).done);c=!0){var h=l.value;d.a.setCollection("items").getWithCondition([{field:"id",op:"==",value:h}],function(e){e[0].stock>0&&e[0].stock<s&&(s=e[0].stock),t.$set(t.combo[i],"stock",s),o.push(e[0])})}}catch(t){a=!0,r=t}finally{try{!c&&u.return&&u.return()}finally{if(a)throw r}}t.$set(t.combo[i],"itemsList",o)})}),d.a.setCollection("discountAll").getWithCondition([{field:"end_time",op:">",value:Date.now()}],function(e){e[0]&&(e[0].start_time<Date.now()&&(t.discount_percent=e[0].discount_percent,t.discount_value=e[0].discount_value),t.getItem())})}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[t._m(0),t._v(" "),i("div",{staticClass:"tab-content mt-1"},[i("div",{staticClass:"container tab-pane active",attrs:{id:"home"}},[i("div",{staticClass:"row d-flex justify-content-around"},t._l(t.items,function(e,s){return i("div",{key:s,staticClass:"card col-md-3 m-2"},[i("div",{staticClass:"card-body"},[i("h4",{staticClass:"card-title"},[t._v(t._s(e.name))]),t._v(" "),i("p",[t._v("Price: "+t._s(e.price))]),t._v(" "),i("p",[t._v("Stock: "+t._s(e.stock))]),t._v(" "),i("p",[t._v("Discount percent: "+t._s(e.discount_percent?e.discount_percent+"%":e.discount_percent))]),t._v(" "),i("p",[t._v("Discount value: "+t._s(e.discount_value))]),t._v(" "),i("button",{staticClass:"btn",on:{click:function(i){t.add(e)}}},[t._v("Add to cart")])])])})),t._v(" "),i("button",{staticClass:"btn",on:{click:function(e){t.more()}}},[t._v("More")])]),t._v(" "),i("div",{staticClass:"container tab-pane",attrs:{id:"menu1"}},[i("table",{staticClass:"table"},[t._m(1),t._v(" "),i("tbody",t._l(t.cart,function(e,s){return i("tr",{key:s},[i("th",{attrs:{scope:"row"}},[t._v(t._s(s+1))]),t._v(" "),i("td",[t._v(t._s(e.name))]),t._v(" "),i("td",[t._v(t._s(e.price))]),t._v(" "),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity,expression:"item.quantity"}],attrs:{type:"number",min:"1",max:e.stock},domProps:{value:e.quantity},on:{input:function(i){i.target.composing||t.$set(e,"quantity",i.target.value)}}})]),t._v(" "),i("td",[i("button",{staticClass:"btn",on:{click:function(e){t.remove(s)}}},[t._v("Ã—")])])])}))]),t._v(" "),i("button",{staticClass:"btn",on:{click:function(e){t.buy()}}},[t._v("Buy")])]),t._v(" "),i("div",{staticClass:"container tab-pane",attrs:{id:"menu2"}},[i("div",{staticClass:"row d-flex justify-content-around"},t._l(t.combo,function(e,s){return e.stock?i("div",{key:s,staticClass:"card col-md-3 m-2"},[i("div",{staticClass:"card-body"},[i("h4",{staticClass:"card-title"},[t._v(t._s(e.name))]),t._v(" "),i("p",[t._v("Price: "+t._s(e.price))]),t._v(" "),i("p",[t._v("Stock: "+t._s(e.stock))]),t._v(" "),i("p",[i("a",{staticClass:"btn btn-primary",attrs:{"data-toggle":"collapse",href:"#"+e.id,role:"button","aria-expanded":"false","aria-controls":e.id}},[t._v("\n              Items:\n            ")])]),t._v(" "),i("div",{staticClass:"collapse",attrs:{id:e.id}},t._l(e.itemsList,function(e,s){return i("div",{key:s,staticClass:"card card-body m-1"},[i("p",[t._v("Name: "+t._s(e.name))]),t._v(" "),i("p",[t._v("Desc: "+t._s(e.desc))])])})),t._v(" "),i("button",{staticClass:"btn",on:{click:function(i){t.add(e)}}},[t._v("Add to cart")])])]):t._e()}))])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"nav nav-tabs"},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{"data-toggle":"tab",href:"#home"}},[this._v("Home")])]),this._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#menu1"}},[this._v("Cart")])]),this._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#menu2"}},[this._v("Combo")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",{staticClass:"thead-dark"},[i("tr",[i("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Name")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Price")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("Quantity")]),t._v(" "),i("th",{attrs:{scope:"col"}},[t._v("#")])])])}]};var m=i("VU/8")(_,v,!1,function(t){i("b4su")},null,null);e.default=m.exports}});
//# sourceMappingURL=1.5bfe1bdc14c991046d0c.js.map